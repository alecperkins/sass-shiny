<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title></title>
    <style>
        body {
            max-width       : 760px;
            margin          : 0 auto;
            padding         : 1em;
            color           : #0c0c0c;
        }
        p code {
            border          : 1px solid #ccc;
            padding         : 0.25em 0.5em;
        }
        h1, h2, h3, h4, h5, h6 {
            position        : relative;
        }
        .deeplink {
            position        : absolute;
            right           : 100%;
            margin-right    : 0.5rem;
            color           : #ccc;
            text-decoration : none;
        }
    </style>
</head>
<body>
    <nav>
        <a href="./index.html">Index</a>
        <a href="./spec.html">Specification</a>
        <a href="./helpers.html">Helpers</a>
    </nav>

    <h1 id="specification">Specification</h1>
<p>The key words &quot;MUST&quot;, &quot;MUST NOT&quot;, &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;, &quot;SHOULD&quot;,
&quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;, &quot;MAY&quot;, and &quot;OPTIONAL&quot; in this document are to be
interpreted as described in <a href="http://tools.ietf.org/html/rfc2119">RFC 2119</a>.</p>
<h2 id="summary">Summary</h2>
<p>Selectors are named to communicate the role and responsibility of the element:</p>
<ul>
<li><em>Module</em>              : <code>ModuleName</code></li>
<li><em>Component</em>           : <code>ModuleName_ComponentName</code></li>
<li>Private <em>Module</em>      : <code>_ModuleName</code></li>
<li><em>Variant</em>             : <code>-variant</code> or <code>-variant_group--value</code></li>
<li><em>State</em>               : <code>[data-state=&quot;value&quot;]</code> or <code>:disabled</code> (built-in)</li>
<li><em>Helper</em>              : <code>H_ModuleName_ComponentName</code></li>
</ul>
<p>Project structure convention to communicate the responsibility of the files:</p>
<pre><code>styles/
    _global/
        _color.sass
        _grid.sass
        _icon.sass
        _typography.sass
    %AbstractModule/
        _%AbstractModule.sass
    Module/
        _Module.sass
        _Module-LAF.sass
        _RelatedModule.sass
        _RelatedModule-LAF.sass
    OtherModule/
        _OtherModule.sass
        _OtherModule-LAF.sass
    Site/
        _Site.sass
        _Site-LAF.sass
    Views/
        _AView.sass
        _AView-LAF.sass
        _ViewName.sass
        _ViewName-LAF.sass
    _config/
      _config.sass
      _theme.sass
    app.sass</code></pre>
<h2 id="modules">Modules</h2>
<p>A <em>Module</em> is a reusable block of appearance and/or functionality. It MAY
contain a number of <em>Components</em>. It MAY have a number of <em>Variants</em> and
<em>States</em>, which are used to modify the <em>Module</em> or <em>Components</em>. <em>Modules</em> MAY
contain other <em>Modules</em>.</p>
<h3 id="specification">Specification</h3>
<ol>
<li><p><em>Modules</em> MUST be in camelcase: <code>ModuleName</code>.</p>
</li>
<li><p><em>Components</em> MUST be prefixed with the <em>Module</em> they belong to, separated
with an underscore: <code>ModuleName_ComponentName</code>.</p>
</li>
<li><p><em>Components</em> SHOULD NOT be nested under their parent <em>Module</em>, unless a
<em>Module</em> <em>Variant</em> needs to modify the <em>Component</em>.</p>
</li>
<li><p>Private <em>Modules</em> SHOULD be prefixed with an underscore: <code>_ModuleName</code>.</p>
</li>
<li><p><em>Components</em> of private <em>Modules</em> SHOULD match the module underscore
prefix: <code>_ModuleName_ComponentName</code>.</p>
</li>
<li><p><em>Variants</em> MUST be prefixed with a hyphen: <code>-variant</code>.</p>
</li>
<li><p><em>Variants</em> MUST be nested under their <em>Module</em> or <em>Component</em>:
<code>&amp;.-variant</code>.</p>
</li>
<li><p><em>Variants</em> SHOULD be lowercase, with underscores separating words:
<code>-variant_name</code>.</p>
</li>
<li><p><em>Variants</em> MAY have subvariants (or be “grouped”), with a value that MUST
be separated using a double hyphen: <code>-variant--value</code>.</p>
</li>
<li><p>Properties under <em>Variants</em> with subvariants SHOULD be exclusive.</p>
</li>
<li><p><em>States</em> MUST be described using <code>data-</code> attributes, unless there is a
built-in version: <code>data-progress=&quot;50&quot;</code> or <code>disabled</code>.</p>
</li>
<li><p>The <em>State</em> selector MUST include the value <code>&quot;true&quot;</code> if it is based
on presence (does not have its own value): <code>data-loading=&quot;true&quot;</code>.</p>
</li>
<li><p><em>Helpers</em>, classes that have no semantic purpose, SHOULD be prefixed with
an <code>H_</code>: <code>H_ModuleName_ComponentWrapper</code>.</p>
</li>
<li><p>Elements SHOULD only have one <em>Module</em> or <em>Component</em> class name, but MAY
have as many <em>Variants</em> or <em>States</em> as necessary.</p>
</li>
<li><p><em>Component</em> presence in an instance of a <em>Module</em> in markup is <em>OPTIONAL</em>,
though dependent on the specific usecase.</p>
</li>
<li><p><em>Modules</em> and <em>Components</em> SHOULD be documented using the Shiny
<a href="./documentation.html">documentation style</a>.</p>
</li>
</ol>
<h3 id="discussion">Discussion</h3>
<ul>
<li><p>If a <em>Component</em> is reusable across different <em>Modules</em>, or outside of the
<em>Module</em>, then it is probably itself a <em>Module</em>. The underscore between the
<code>ModuleName</code> and <code>ComponentName</code> is intended to suggest that the <em>Component</em>
is private to the <em>Module</em>.</p>
</li>
<li><p>Camelcase is chosen to help differentiate the <em>Modules</em> and <em>Components</em>
from classes for variants, or standalone classes. Also, it stands out in
normal text without additional formatting, helpful for documentation. An
added bonus is it follows conventions used in frontend or backend logic,
such as a Backbone or Django View, which makes it easy to associate the
markup, style, and script that are responsible for that module.</p>
</li>
<li><p><em>Modules</em> can contain other <em>Modules</em>, instead of having a separate “layout”
concept. A list-type <em>Module</em> could be a layout as it contains <em>Modules</em> for
the list items. But, the list itself also may have some additional
functionality, like sorting or searching, that is provided by its own
<em>Components</em> or other <em>Modules</em>. Variants could be used to control the
layout of the list, like <code>-list</code> or <code>-grid--three</code> or <code>-grid--four</code>.</p>
</li>
<li><p>The names “module” and “component” are chosen over “block” and “element”,
since those have other meanings in this context (display: block, content
block, HTML element). “Module” and “Component” also correlate with the same
JavaScript concepts. “Variant” was chosen over “modifier” for no particular
reason other than it didn’t start with an <code>m</code> as “Module” does.</p>
</li>
<li><p>Keeping <em>Variants</em> separate from the full <em>Module</em> or <em>Component</em> name
(compared to schemes like BEM), makes it easier to recombine them, and is
generally less verbose. The nesting requirement and hyphen prefixing allows
for avoiding the problem of overly generic <em>Variant</em> names, like <code>.active</code>.
Not using the full module prefixing still allows for global adjustments to
variants for debugging purposes, eg <code>.-active { border: 1px solid red }</code>.
(This may be necessary in non-debugging situations, but is a bad idea so is
considered a violation of the Shiny spec.) Also, it’s possible to detect a
non-nested class prefixed with a hyphen using a linter, to enforce this rule.</p>
</li>
<li><p>Singular <em>Variants</em> are considered “flags” or “switches”, and generally
should be useful in different combinations, like
<code>class=&quot;Story -featured -selected&quot;</code>. <em>Variants</em> with subvariants are
considered a property and a value, and are best used exclusively from each
other, like <code>class=&quot;StoryList -grid--three&quot;</code> or
<code>class=&quot;StoryList -grid-four -selected&quot;</code>.</p>
</li>
<li><p><em>States</em> versus <em>Variants</em> is potentially fuzzy. A good differentiator is if
it is being modified by JavaScript, like “disabled”, “loading”, or
“progress”, it’s a <em>State</em>. If it is not going to change once the page
loads, it is a <em>Variant</em>. It’s also a good idea to keep the <em>State</em> values
JSON-compatible, since some JavaScript libraries parse <code>data-</code> attributes as
JSON when accessing them. (This is also why the <code>&quot;true&quot;</code> is required.)</p>
</li>
<li><p>The <em>Helper</em> distinction makes it clear that the element with that class has
no semantic role, and can be modified or removed as the look-and-feel
dictate.</p>
</li>
<li><p>More sophisticated selector prefixes, with characters like <code>^</code> and <code>+</code> are
possible, but are easy to confuse with things like regex and sibling
selectors.</p>
</li>
</ul>
<h3 id="example">Example</h3>
<p>The following example describes a <code>Container</code> <em>Module</em>, and an <code>Item</code> <em>Module</em>
with <code>Item_Cover</code>, <code>Item_Title</code>, and <code>Item_ContentPreview</code> components.</p>
<pre><code class="lang-sass">.Container
    max-width   : 1280px
    margin      : 0 auto
    &amp;.-full
        max-width: none
    &amp;.-spaceless
        font-size: 0
        &gt; *
            font-size: 1rem

.Item_Cover
    background-size : cover
    height          : 200px

.Item_Title
    text-align: center

.Item_ContentPreview
    padding: 1em
    &amp;.-truncated
        &amp;:after
            content: &#39;…&#39;

.H_Item_TagWrapper
    position: relative

.Item_Tag
    position    : absolute
    bottom      : 100%
    left        : 0

.Item
    width: 100%

    &amp;.-size--fourth
        width: 25%
        .Item_Cover
            height: 50px

    &amp;.-size--third
        width: 33.33333%
        .Item_Cover
            height: 75px

    &amp;.-size--half
        width: 50%
        .Item_Cover
            height: 100px

    &amp;[data-loading=&quot;true&quot;]
        border: 1px solid green</code></pre>
<p>At a specific moment in time, accounting for the state being controlled by JS,
the corresponding HTML structure would look something like:</p>
<pre><code class="lang-html">&lt;div class=&quot;Container -spaceless&quot;&gt;
    &lt;div class=&quot;Item&quot;&gt;
        &lt;div class=&quot;H_Item_TagWrapper&quot;&gt;
            &lt;div class=&quot;Item_Tag&quot;&gt;Featured&lt;/div&gt;
        &lt;/div&gt;
        &lt;div class=&quot;Item_Cover&quot; style=&quot;background-image: url()&quot;&gt;&lt;/div&gt;
        &lt;h2 class=&quot;Item_Title&quot;&gt;The title of the story&lt;/h2&gt;
        &lt;p class=&quot;Item_ContentPreview -truncated&quot;&gt;
            Some limited preview of the story with some of the
        &lt;/p&gt;
    &lt;/div&gt;
    &lt;div class=&quot;Item -size--half&quot; data-loading=&quot;true&quot;&gt;
        &lt;div class=&quot;Item_Cover&quot; style=&quot;background-image: url()&quot;&gt;&lt;/div&gt;
        &lt;h2 class=&quot;Item_Title&quot;&gt;Another story in the list&lt;/h2&gt;
        &lt;p class=&quot;Item_ContentPreview&quot;&gt;
            Photo-based story so little text preview.
        &lt;/p&gt;
    &lt;/div&gt;
    &lt;div class=&quot;Item -size--half&quot;&gt;
        &lt;div class=&quot;Item_Cover&quot; style=&quot;background-image: url()&quot;&gt;&lt;/div&gt;
        &lt;h2 class=&quot;Item_Title&quot;&gt;A third story&lt;/h2&gt;
        &lt;p class=&quot;Item_ContentPreview -truncated&quot;&gt;
            Some limited preview of the story with some of the
        &lt;/p&gt;
    &lt;/div&gt;
    &lt;!--
        ...more story Items...
    --&gt;
&lt;/div&gt;</code></pre>
<p>The first story is “featured”, so it is full width, while the rest of the
stories present themselves as half-size. The first story also gets a tag
indicating its featured status, which needs a helper wrapper for positioning.
(Note that the featured story has additional <em>Components</em> that the other 
instances of the <code>Item</code> <em>Module</em> do not have.) The second story is currently
being loaded using a method such as <a href="https://github.com/defunkt/jquery-pjax">Pjax</a>,
so it’s in a <code>loading</code> state.</p>
<h2 id="structure">Structure</h2>
<p>Rules are organized into files by <em>Module</em>, Those that are structural or
behavioral are kept separate from rules responsible for “Look-and-Feel” (LAF).
Everything is pulled together using a single manifest-type file, that is
responsible for load order.</p>
<h3 id="specification">Specification</h3>
<ol>
<li><p>Files that are not linked in the page MUST be prefixed with an underscore.</p>
</li>
<li><p>Common functions and mixins SHOULD go into a <code>_global.sass</code> file or a
<code>_global/</code> folder. They MAY be organized into different files and folders
within the <code>_global</code> folder as necessary to maintain logical organization.</p>
</li>
<li><p>Configuration settings, like fontstacks, colors, icon sets, and grid sizes
SHOULD be placed in a <code>_config.sass</code> or a <code>_config/</code> folder. They MAY be
organized into different files and folders within the <code>_config</code> folder as
necessary to maintain logical organization.</p>
</li>
<li><p>Structural and behavioral rules for a <em>Module</em> and its <em>Components</em> SHOULD
be placed together in one file, and SHOULD be within a folder that
contains only that <em>Module</em> or conceptually related <em>Modules</em>.</p>
</li>
<li><p>The file for a <em>Module</em> SHOULD be named the same as the <em>Module</em>.</p>
</li>
<li><p>Files and folders that contain only abstract <em>Modules</em> (defined with
placeholder selectors) SHOULD be prefixed with a percent sign <code>%</code>:
<code>_%AbstractModule.sass</code>.</p>
</li>
<li><p>Look-and-Feel rules SHOULD be in a separate file, within the same folder
as the primary <em>Module</em> rules. If present, this file MUST be suffixed with
<code>LAF</code>: <code>ModuleName-LAF.sass</code>.</p>
</li>
<li><p>Rules for specific views (pages) SHOULD be treated as a <em>Module</em>, with
their own folder and files named as such.</p>
</li>
<li><p><em>Modules</em> for specific views MAY be aggregated into a <code>Views</code> folder if
there is a small number of rules for each of those Views.</p>
</li>
<li><p>Rules for site-wide styles, such as general LAF and base structure, SHOULD
be in a <em>Module</em> named <code>Site</code>.</p>
</li>
<li><p>There SHOULD be one file — the <em>manifest</em> — that is not prefixed with an
underscore, and SHOULD be named <code>app.sass</code>.</p>
</li>
<li><p>There MAY be other <em>manifests</em>, for more selective loading of styles.</p>
</li>
</ol>
<h3 id="discussion">Discussion</h3>
<ul>
<li><p>There is an appeal to having each file import the parts it needs. However,
the global nature of Sass/CSS and the behavior of placeholder selectors
means this keeping this managable is often more trouble than it’s worth.
Hacks like the <code>+exports</code> trick introduce their own share of complexity.</p>
</li>
<li><p>The distinction between LAF and structural is fuzzy, and varies depending on
circumstance. In one usage, <code>margin</code> may simply increase the whitespace
around and element, and has no bearing on the raw functionality. In other,
<code>margin</code> may be the primary factor in establishing a certain layout. If a
declaration can be omitted without sacrificing functionality, it should be
considered LAF. These commonly are colors, fonts, and often padding and
text alignment. Even <code>display</code> could be considered LAF, but is more commonly
a structural style. Any declaration that significantly changes the position
of an element, its sizing, or its relationship to surrounding elements,
should be considered structural. It’s very usecase specific and requires
sound judgement.</p>
</li>
<li><p>Many of the items in this section are “SHOULD” instead of “MUST”.
Organization is very project- and workflow-specific, so it doesn’t make
sense to have strict </p>
</li>
</ul>


    <script>
        (function(){
            var heading_counts = {};
            var heading_stack = []
            var heading_els = document.querySelectorAll('h1, h2, h3, h4, h5, h6');
            for(var i = 0; i < heading_els.length; i++) {
                var current_heading = heading_els[i];
                current_heading.level = parseInt(current_heading.tagName.substring(1));
                while(heading_stack[heading_stack.length - 1] && heading_stack[heading_stack.length - 1].level > current_heading.level) {
                    heading_stack.pop()
                }
                heading_stack.push(current_heading);
                var parent_id = '';
                if(heading_stack.length > 1) {
                    parent_id = heading_stack[heading_stack.length - 2].id;
                }
                var text = current_heading.innerText;
                var slug = text.toLowerCase().replace(/\W/g,'-').split(/\s/).join('-');
                if(slug[0] === '-') {
                    slug = slug.substring(1);
                }
                slug = parent_id + '/' + slug;
                if(!heading_counts[slug]) {
                    heading_counts[slug] = 0;
                }
                heading_counts[slug]++;
                if(heading_counts[slug] > 1) {
                    slug = slug + '-' + heading_counts[slug].toString()
                }
                current_heading.id = slug;
                current_heading.innerHTML = '<a class="deeplink" href="#' + slug + '">#</a>' + current_heading.innerHTML
            }
        })();
    </script>
</body>
</html>